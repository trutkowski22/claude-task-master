```mermaid
graph TB
    subgraph "Clear Subtasks Tool (clear-subtasks.js)"
        A[registerClearSubtasksTool] --> B[Define Tool Schema]
        B --> C[Tool: clear_subtasks]
        
        C --> D[Parameters]
        D --> E[id: Task IDs to clear from]
        D --> F[all: Clear from all tasks flag]
        D --> G[file: Optional tasks file path]
        D --> H[projectRoot: Project directory]
        D --> I[tag: Optional tag context]
        
        C --> J[Parameter Validation]
        J --> K{id OR all provided?}
        K -->|No| L[Validation Error]
        K -->|Yes| M[Execute Handler]
        
        M --> N[withNormalizedProjectRoot wrapper]
        N --> O[Log clearing operation]
        O --> P[resolveTag]
        P --> Q[findTasksPath]
        Q --> R{Path found?}
        
        R -->|No| S[Return error response]
        R -->|Yes| T[clearSubtasksDirect]
        
        T --> U{Success?}
        U -->|Yes| V[Log success]
        U -->|No| W[Log error]
        
        V --> X[handleApiResult]
        W --> X
        X --> Y[Return formatted response]
        
        M --> Z[Error Handling]
        Z --> AA[createErrorResponse]
    end
    
    subgraph "External Dependencies"
        BB[utils.js]
        CC[task-master-core.js]
        DD[path-utils.js]
        EE[scripts/modules/utils.js]
    end
    
    BB --> N
    BB --> S
    BB --> X
    BB --> AA
    CC --> T
    DD --> Q
    EE --> P
    
    style A fill:#e1f5fe
    style C fill:#f3e5f5
    style M fill:#e8f5e8
    style T fill:#fff3e0
    style J fill:#ffebee
```