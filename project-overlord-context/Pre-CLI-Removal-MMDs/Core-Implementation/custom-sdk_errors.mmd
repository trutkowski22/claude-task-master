
graph TD
    A[errors.js] --> B[Error Classes]
    A --> C[Error Mapping Functions]
    A --> D[Error Utilities]
    
    B --> E[MCPError Class]
    B --> F[MCPSessionError Class]
    B --> G[MCPSamplingError Class]
    
    E --> H[Base Error Properties]
    H --> I[message: string]
    H --> J[name: 'MCPError']
    H --> K[code: string]
    H --> L[cause: Error]
    H --> M[mcpResponse: object]
    
    F --> N[Session Error Properties]
    N --> O[extends MCPError]
    N --> P[name: 'MCPSessionError']
    
    G --> Q[Sampling Error Properties]
    Q --> R[extends MCPError]
    Q --> S[name: 'MCPSamplingError']
    
    C --> T[mapMCPError Function]
    T --> U{Error Type Check}
    U -->|instanceof MCPError| V[Return As-Is]
    U -->|session/connection| W[MCPSessionError]
    U -->|sampling/timeout| X[MCPSamplingError]
    U -->|capabilities/not supported| Y[MCPSessionError]
    U -->|default| Z[Generic MCPError]
    
    W --> AA[SESSION_ERROR code]
    X --> BB[SAMPLING_ERROR code]
    Y --> CC[CAPABILITY_ERROR code]
    Z --> DD[UNKNOWN_ERROR code]
    
    D --> EE[isRetryableError Function]
    EE --> FF{Retry Logic}
    FF -->|MCPSamplingError + SAMPLING_ERROR| GG[true]
    FF -->|MCPSessionError + SESSION_ERROR| HH[false]
    FF -->|timeout/network/temporary| II[true]
    FF -->|other| JJ[false]
    
    style A fill:#e1f5fe
    style B fill:#f3e5f5
    style C fill:#e8f5e8
    style D fill:#fff3e0
    style T fill:#e3f2fd
    style EE fill:#e3f2fd
    style U fill:#ffebee
    style FF fill:#ffebee
